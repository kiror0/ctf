<!doctype html>

<html lang="en-us">

<head>
  <title>Catousify</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="The HTML5 Herald" />
  <meta name="author" content="kiror0" /><meta name="generator" content="Hugo 0.62.0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css" />
  <script src="https://kit.fontawesome.com/b76b73e8e8.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  <link rel="stylesheet" type="text/css" href="http://kiror0.github.io/ctf/css/styles.css" /></head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="http://kiror0.github.io/ctf/">Catousify</a>
            </h1>

      <ul id="social-media">
        
        
          
        <li><a href="https://github.com/kiror0"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a></li>
           
      </ul>
      
      <p><em>No Clever Tagline Needed.</em></p>
      
    </header>

    
<nav>
    <ul>
        
        <li>
            <a class="" href="http://kiror0.github.io/ctf/posts/">
                <i class="fa-li fa  fa-lg"></i><span>Posts</span>
            </a>
        </li>
        
        <li>
            <a class="" href="http://kiror0.github.io/ctf/about/">
                <i class="fa-li fa  fa-lg"></i><span>About Me</span>
            </a>
        </li>
        
    </ul>
</nav>

    <main>




<article>

    <h1>JOINTS 2018 - Simple VM WriteUp</h1>

    
        <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2018-05-07T18:14:01Z">May 7, 2018</time>
        </li>
        
        <li>
            Categories:
            <em>
                
                    
                    <a href="http://kiror0.github.io/ctf/categories/rev">rev</a>
                
                    , 
                    <a href="http://kiror0.github.io/ctf/categories/writeup">writeup</a>
                
            </em>
        </li>
        

        

        <li>7 minutes read</li>
    </ul>
</aside>

    

    <p><em>psst: Post ini akan banyak sisipan rant dan commentary saat sesi Final JOINTS 2018.</em> Hasil decompile binary ELF di IDA pro agak cukup berantakan, Jadi, saya buka di graph view untuk analisa opcode. Hasilnya, agak terhambat di bagian byte 0xD1 - 0xD5. Tapi, akhirnya source code soal dibagikan saat menjelang akhir lomba. btw, kalau bisa ada hint yang di keluarkan tolong diumumkan langusng, ehe. cc: panitia Source code soal <em>redacted</em>,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#75715e">#</span><span style="color:#75715e">include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#75715e">#</span><span style="color:#75715e">include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#75715e">#</span><span style="color:#75715e">include</span> <span style="color:#75715e">&lt;stdint.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>reg;
<span style="color:#66d9ef">char</span> data[<span style="color:#ae81ff">60</span>];
<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>ins <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\x64</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x5b</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x02</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x03</span><span style="color:#ae81ff">\x5a</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x04</span><span style="color:#ae81ff">\x71</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x05</span><span style="color:#ae81ff">\x6f</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x06</span><span style="color:#ae81ff">\x71</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x07</span><span style="color:#ae81ff">\x7d</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x08</span><span style="color:#ae81ff">\x47</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x09</span><span style="color:#ae81ff">\x43</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x0a</span><span style="color:#ae81ff">\x5e</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x0b</span><span style="color:#ae81ff">\x42</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x0c</span><span style="color:#ae81ff">\x4b</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x0d</span><span style="color:#ae81ff">\x71</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x0e</span><span style="color:#ae81ff">\x61</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x0f</span><span style="color:#ae81ff">\x5e</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x10</span><span style="color:#ae81ff">\x4d</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x11</span><span style="color:#ae81ff">\x1e</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x12</span><span style="color:#ae81ff">\x4a</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x13</span><span style="color:#ae81ff">\x1d</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x14</span><span style="color:#ae81ff">\x24</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x15</span><span style="color:#ae81ff">\x2e</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\x05</span><span style="color:#ae81ff">\x01</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\x14</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x2a</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x02</span><span style="color:#ae81ff">\x03</span><span style="color:#ae81ff">\x01</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\x70</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x03</span><span style="color:#ae81ff">\x2e</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x02</span><span style="color:#ae81ff">\x04</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xcf</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\x03</span><span style="color:#ae81ff">\x04</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xd1</span><span style="color:#ae81ff">\x0e</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xac</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\x01</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xac</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xd5</span><span style="color:#ae81ff">\xe8</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\x05</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">\
</span><span style="color:#e6db74"></span><span style="color:#ae81ff">\xff</span><span style="color:#e6db74">&#34;</span>;

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">vm</span>(){
    <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">int</span> temp;
    <span style="color:#66d9ef">char</span> flag;
    reg <span style="color:#f92672">=</span> malloc(<span style="color:#ae81ff">5</span>);
    <span style="color:#66d9ef">while</span>(<span style="color:#ae81ff">1</span>){
        <span style="color:#66d9ef">if</span>( ins[i] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)<span style="color:#ae81ff">0xc3</span> ){ <span style="color:#75715e">// mov
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x01</span><span style="color:#e6db74">&#39;</span> ){
                data[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ] <span style="color:#f92672">=</span> ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>];
            }
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x00</span><span style="color:#e6db74">&#39;</span> ){
                reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ] <span style="color:#f92672">=</span> ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>];

            }
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x03</span><span style="color:#e6db74">&#39;</span>){
                temp <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>)reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ];
                data[temp] <span style="color:#f92672">=</span> ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>];
            }
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x04</span><span style="color:#e6db74">&#39;</span>){
                data[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ] <span style="color:#f92672">=</span> reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>] ];
            }
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x02</span><span style="color:#e6db74">&#39;</span>){
                temp <span style="color:#f92672">=</span> reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>] ];
                reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ] <span style="color:#f92672">=</span> data[ temp ];
            }
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x06</span><span style="color:#e6db74">&#39;</span>){
                reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ] <span style="color:#f92672">=</span> data[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>] ];
            }
            i <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>;
            <span style="color:#66d9ef">continue</span>;
        }
        <span style="color:#66d9ef">if</span>( ins[i] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)<span style="color:#ae81ff">0xab</span>){
            <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)<span style="color:#ae81ff">0x01</span>)
                flag <span style="color:#f92672">=</span> (data[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ] <span style="color:#f92672">+</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>) <span style="color:#ae81ff">1</span>);
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)<span style="color:#ae81ff">0x00</span>)
                flag <span style="color:#f92672">=</span> (reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ] <span style="color:#f92672">+</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>) <span style="color:#ae81ff">1</span>);
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x03</span><span style="color:#e6db74">&#39;</span> ){
                temp <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>)reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ];
                data[temp] <span style="color:#f92672">+</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>) <span style="color:#ae81ff">1</span>;
                flag <span style="color:#f92672">=</span> data[temp];
            }
            i <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>;
            <span style="color:#66d9ef">continue</span>;
        }
        <span style="color:#66d9ef">if</span>( ins[i] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)<span style="color:#ae81ff">0xac</span>){
            <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)<span style="color:#ae81ff">0x01</span>)
                flag <span style="color:#f92672">=</span> (data[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ] <span style="color:#f92672">-</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>) <span style="color:#ae81ff">1</span>);
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)<span style="color:#ae81ff">0x00</span>)
                flag <span style="color:#f92672">=</span> (reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ] <span style="color:#f92672">-</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>) <span style="color:#ae81ff">1</span>);
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x03</span><span style="color:#e6db74">&#39;</span> ){
                temp <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>)reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ];
                data[temp] <span style="color:#f92672">-</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>) <span style="color:#ae81ff">1</span>;
                flag <span style="color:#f92672">=</span> data[temp];
            }
            i <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>;
            <span style="color:#66d9ef">continue</span>;
        }
        <span style="color:#66d9ef">if</span>( ins[i] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)<span style="color:#ae81ff">0xcf</span>){ <span style="color:#75715e">// cmp
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)<span style="color:#ae81ff">0x00</span>){
                flag <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)(reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ] <span style="color:#f92672">-</span> reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>] ]);
            }
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x01</span><span style="color:#e6db74">&#39;</span>){
                flag <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)(reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ] <span style="color:#f92672">-</span> ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>] );
            }
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x02</span><span style="color:#e6db74">&#39;</span>){
                flag <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)(data[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ] <span style="color:#f92672">-</span> ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>] );
            }
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x03</span><span style="color:#e6db74">&#39;</span>){
                flag <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)(data[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ] <span style="color:#f92672">-</span> reg[(<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>]]);
            }
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x04</span><span style="color:#e6db74">&#39;</span>){
                flag <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)(reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ] <span style="color:#f92672">-</span> data[(<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>]]);
            }
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x05</span><span style="color:#e6db74">&#39;</span>){
                temp <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>)reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ];
                flag <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)( data[temp] <span style="color:#f92672">-</span> reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>]]);
            }
            i <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>;
            <span style="color:#66d9ef">continue</span>;
        }
        <span style="color:#66d9ef">if</span>((ins[i] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)<span style="color:#ae81ff">0xd0</span> <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> flag <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">|</span><span style="color:#f92672">|</span>
           (ins[i] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)<span style="color:#ae81ff">0xd1</span> <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> flag <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">|</span><span style="color:#f92672">|</span>
           (ins[i] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)<span style="color:#ae81ff">0xd2</span> <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> flag <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span> ) <span style="color:#f92672">|</span><span style="color:#f92672">|</span>
           (ins[i] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)<span style="color:#ae81ff">0xd3</span> <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> flag <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">|</span><span style="color:#f92672">|</span>
           (ins[i] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)<span style="color:#ae81ff">0xd4</span> <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> flag <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> ) <span style="color:#f92672">|</span><span style="color:#f92672">|</span>
           (ins[i] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)<span style="color:#ae81ff">0xd5</span> <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> flag <span style="color:#f92672">&gt;</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>) <span style="color:#f92672">|</span><span style="color:#f92672">|</span>
           (ins[i] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)<span style="color:#ae81ff">0xd6</span>)){
            i <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)i <span style="color:#f92672">+</span> ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>];
            <span style="color:#66d9ef">continue</span>;
        }<span style="color:#66d9ef">else</span>{
            <span style="color:#66d9ef">if</span>((uint8_t)ins[i] <span style="color:#f92672">&gt;</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">0xd0</span> <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> (uint8_t)ins[i] <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">0xd5</span>){
                i <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;
                <span style="color:#66d9ef">continue</span>;
            }
        }
        <span style="color:#66d9ef">if</span>( ins[i] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">0x70</span> ){
            <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x00</span><span style="color:#e6db74">&#39;</span> ){
                flag <span style="color:#f92672">=</span> (reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ] <span style="color:#f92672">^</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>) reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>] ]);
            }
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x01</span><span style="color:#e6db74">&#39;</span>){
                flag <span style="color:#f92672">=</span> (reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ] <span style="color:#f92672">^</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>) ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>]);
            }
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x02</span><span style="color:#e6db74">&#39;</span>){
                flag <span style="color:#f92672">=</span> (reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ] <span style="color:#f92672">^</span><span style="color:#f92672">=</span> data[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>] ]);
            }
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x03</span><span style="color:#e6db74">&#39;</span>){
                flag <span style="color:#f92672">=</span> (data[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ] <span style="color:#f92672">^</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>) ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>]);
            }
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x04</span><span style="color:#e6db74">&#39;</span>){
                temp <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>) reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ];
                flag <span style="color:#f92672">=</span> (data[temp] <span style="color:#f92672">^</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>) ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>] );
            }
            <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>( ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">\x05</span><span style="color:#e6db74">&#39;</span>){
                temp <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span>) reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>] ];
                flag <span style="color:#f92672">=</span> (data[temp] <span style="color:#f92672">^</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>) reg[ (<span style="color:#66d9ef">int</span>)ins[i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>]] );
            }
            i <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>;
            <span style="color:#66d9ef">continue</span>;
        }
        <span style="color:#66d9ef">if</span>( ins[i] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>)<span style="color:#ae81ff">0xff</span> ) <span style="color:#66d9ef">break</span>;
    }

    <span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">int</span>)reg[<span style="color:#ae81ff">5</span>];
}

<span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>){
    printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Simple VM</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
    printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Masukkan password : </span><span style="color:#e6db74">&#34;</span>);
    fgets((<span style="color:#66d9ef">char</span><span style="color:#f92672">*</span>)data<span style="color:#f92672">+</span><span style="color:#ae81ff">22</span>,<span style="color:#ae81ff">23</span>,stdin);
    <span style="color:#66d9ef">if</span>( vm() <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>){
        printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Password Salah</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
        <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
    }
    printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Password Benar</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
}
</code></pre></div><p>Pada awal fungsi vm(), ada pemanggilan malloc() untuk alokasi reg[]. Dari ini, bisa dipastikan ada 5 local register dengan Instruction Pointer pada [rbp - 4], instruksi/opcode-nya sendiri ada pada ins[] di data section, memang, sudah dijelaksan, pada judul soalnya, tidak muluk-muluk, benar-benar <em>simpel</em>. Untuk analisa opcode, saya buat parser seadanya dengan python. Berikut scriptnya,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> struct <span style="color:#f92672">import</span> unpack

opcode <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\x64</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x5b</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x02</span><span style="color:#ae81ff">\x1b</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x03</span><span style="color:#ae81ff">\x5a</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x04</span><span style="color:#ae81ff">\x71</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x05</span><span style="color:#ae81ff">\x6f</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x06</span><span style="color:#ae81ff">\x71</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x07</span><span style="color:#ae81ff">\x7d</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x08</span><span style="color:#ae81ff">\x47</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x09</span><span style="color:#ae81ff">\x43</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x0a</span><span style="color:#ae81ff">\x5e</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x0b</span><span style="color:#ae81ff">\x42</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x0c</span><span style="color:#ae81ff">\x4b</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x0d</span><span style="color:#ae81ff">\x71</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x0e</span><span style="color:#ae81ff">\x61</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x0f</span><span style="color:#ae81ff">\x5e</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x10</span><span style="color:#ae81ff">\x4d</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x11</span><span style="color:#ae81ff">\x1e</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x12</span><span style="color:#ae81ff">\x4a</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x13</span><span style="color:#ae81ff">\x1d</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x14</span><span style="color:#ae81ff">\x24</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x15</span><span style="color:#ae81ff">\x2e</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\x05</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\x14</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x2a</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x02</span><span style="color:#ae81ff">\x03</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\x70</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\x03</span><span style="color:#ae81ff">\x2e</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x02</span><span style="color:#ae81ff">\x04</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xcf</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\x03</span><span style="color:#ae81ff">\x04</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xd1</span><span style="color:#ae81ff">\x0e</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xac</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\x01</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xac</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xd5</span><span style="color:#ae81ff">\xe8</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xc3</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\x05</span><span style="color:#ae81ff">\x00</span><span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span><span style="color:#ae81ff">\xff</span><span style="color:#e6db74">&#34;</span>

i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
cnt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>

u1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> x: unpack(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span>, x)[<span style="color:#ae81ff">0</span>]

<span style="color:#66d9ef">while</span> i <span style="color:#f92672">&lt;</span> len(opcode):
    <span style="color:#66d9ef">if</span> opcode[i] <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\xc3</span><span style="color:#e6db74">&#39;</span>:
        mode <span style="color:#f92672">=</span> opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]
        <span style="color:#66d9ef">if</span> mode <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#39;</span>:
            <span style="color:#66d9ef">print</span> str(i)<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">3</span>), <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">reg[{}] = {}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(u1(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>]), u1(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">3</span>]))
        <span style="color:#66d9ef">elif</span> mode <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x01</span><span style="color:#e6db74">&#39;</span>:
            <span style="color:#66d9ef">print</span> str(i)<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">3</span>), <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">data[{}] = {}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(u1(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>]), u1(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">3</span>]))
        <span style="color:#66d9ef">elif</span> mode <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x02</span><span style="color:#e6db74">&#39;</span>:
            <span style="color:#66d9ef">print</span> str(i)<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">3</span>), <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">reg[{}] = data[reg[{}]]</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(u1(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>]), u1(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">3</span>]))
        i <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>
        cnt <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">elif</span> opcode[i] <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x70</span><span style="color:#e6db74">&#39;</span>:
        mode <span style="color:#f92672">=</span> opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]
        <span style="color:#66d9ef">if</span> mode <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x01</span><span style="color:#e6db74">&#39;</span>:
            <span style="color:#66d9ef">print</span> str(i)<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">3</span>), <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">flag = reg[{}] ^= {}</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(u1(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>]), u1(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">3</span>]))
        i <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>
        cnt <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">elif</span> opcode[i] <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\xcf</span><span style="color:#e6db74">&#39;</span>:
        mode <span style="color:#f92672">=</span> opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]
        <span style="color:#66d9ef">if</span> mode <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#39;</span>:
            <span style="color:#66d9ef">print</span> str(i)<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">3</span>), <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">flag = reg[{}] - reg[{}]</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(u1(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>]), u1(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">3</span>]))
        i <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span>
        cnt <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">elif</span> opcode[i] <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\xd1</span><span style="color:#e6db74">&#39;</span>:
        <span style="color:#66d9ef">print</span> str(i)<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">3</span>), <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">jmp +{}, if flag != 0</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(u1(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]))
        i <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
        cnt <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">elif</span> opcode[i] <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\xd5</span><span style="color:#e6db74">&#39;</span>:
        <span style="color:#66d9ef">print</span> str(i)<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">3</span>), <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">jmp {}, if flag &gt;= 0</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(u1(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]))
        i <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
        cnt <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">elif</span> opcode[i] <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\xac</span><span style="color:#e6db74">&#39;</span>:
        <span style="color:#66d9ef">print</span> str(i)<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">3</span>), <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">flag = (reg[{}] -= 1)</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>format(u1(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>]))
        i <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
        cnt <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">elif</span> opcode[i] <span style="color:#f92672">==</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\xff</span><span style="color:#e6db74">&#39;</span>:
        <span style="color:#66d9ef">print</span> str(i)<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">3</span>), <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">break</span><span style="color:#e6db74">&#34;</span>
        i <span style="color:#f92672">+</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Unhandled opcode</span><span style="color:#e6db74">&#34;</span>, repr(opcode[i])
        <span style="color:#66d9ef">break</span>

<span style="color:#66d9ef">print</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">total</span><span style="color:#e6db74">&#34;</span>, cnt, <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">ins</span><span style="color:#e6db74">&#34;</span>
</code></pre></div><p>Output dari parser,</p>
<pre><code>000 data[0] = 100
004 data[1] = 91
008 data[2] = 27
012 data[3] = 90
016 data[4] = 113
020 data[5] = 111
024 data[6] = 113
028 data[7] = 125
032 data[8] = 71
036 data[9] = 67
040 data[10] = 94
044 data[11] = 66
048 data[12] = 75
052 data[13] = 113
056 data[14] = 97
060 data[15] = 94
064 data[16] = 77
068 data[17] = 30
072 data[18] = 74
076 data[19] = 29
080 data[20] = 36
084 data[21] = 46
088 reg[5] = 1
092 reg[0] = 20
096 reg[1] = 42
100 reg[3] = data[reg[1]]
104 flag = reg[3] ^= 46
108 reg[4] = data[reg[0]]
112 flag = reg[3] - reg[4]
116 jmp +14, if flag != 0
118 flag = (reg[1] -= 1)
121 flag = (reg[0] -= 1)
124 jmp -24, if flag &gt;= 0
126 reg[5] = 0
130 break
total 34 ins
</code></pre><p>pada bytes 000 - 084 ada inisialisasi data yang sepertinya akan dijadikan sebuah konstanta cek. Oh iya, perlu diperhatikan juga, data[22] sampai data[44] digunakan untuk user input.</p>
<pre><code>088 reg[5] = 1
092 reg[0] = 20
096 reg[1] = 42
100 reg[3] = data[reg[1]]
104 reg[3] ^= 46
108 reg[4] = data[reg[0]]
112 flag = reg[3] - reg[4]
116 jmp +14, if flag != 0
118 flag = (reg[1] -= 1)
121 flag = (reg[0] -= 1)
124 jmp -24, if flag &gt;= 0
126 reg[5] = 0
130 break
</code></pre><p>Ugh.. nani!?!?! Ubah ke pseudo-C agar lebih mudah dibaca,</p>
<pre><code>reg[5] = 1;
reg[0] = 20;
reg[1] = 42;
_loop:
if (data[reg[1]--] ^ 46 != data[reg[0]])
    goto _exit;
else
    goto _loop;
reg[5] = 0;
_exit:
    break;
</code></pre><p>Setidaknya hasilnya lebih nyaman dibaca. Terus, Apasih yang dilakukan? reg[0] dan reg[1] jadi counter untuk loop. Awal reg[1] =&gt; 42, daerah user input, reg[0] =&gt; 20, daerah data yang diinisialisasi sebelumnya. So, ini cuma xor data di user input dengan 46 dan mengeceknya dengan konstan data yang diinisialisasi sebelumnya. Boom. Buat solver-nya,</p>
<pre><code>data = [100,91,27,90,113,111,113,125,71,67,94,66,75,113,97,94,77,30,74,29,36,46]
raw = map(chr, map(lambda x: x ^ 46, data))
print ''.join(raw)
</code></pre><p>Output dari solver-nya dan check pada soal:</p>
<pre><code>λ › python solve.py
Ju5t_A_Simple_Opc0d3

λ › python ./vm
Simple VM
Masukkan password : Ju5t_A_Simple_Opc0d3
Password Benar
</code></pre><p>FLAG : <code>JOINTS18{Ju5t_A_Simple_Opc0d3}</code></p>
<hr>
<p>Ada sedikit cerita dramatis pas solve soal ini karena baru bisa solve pas <strong><em>banget</em></strong> waktu untuk submit flag baru ditutup. Yep, setidaknya sempet ngerjain soal yang unik satu ini :v. Kudos untuk siapapun yang buat soal. Gud juga. Kerad. Sangad.</p>


</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="http://kiror0.github.io/ctf/posts/sharifctf-2018-fhash-writeup/"><i class="fa fa-chevron-circle-left"></i> SharifCTF 2018 - fHash Writeup</a>
        </li>
        
        
        <li>
            <a href="http://kiror0.github.io/ctf/posts/security-fest-ctf-2018-sshnuke/">Security Fest CTF 2018 - sshnuke <i class="fa fa-chevron-circle-right"></i> </a>
        </li>
        
    </ul>
</section>
    





</main>
    <footer>
        <h6>Copyright © 2019 - kiror0 |
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="http://kiror0.github.io/ctf/index.xml">Subscribe</a></h6>
    </footer>
</div>
<script src="http://kiror0.github.io/ctf/js/scripts.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-146594173-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


</body>

</html>
