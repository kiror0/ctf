<!doctype html>

<html lang="en-us">

<head>
  <title>Catousify</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="The HTML5 Herald" />
  <meta name="author" content="kiror0" /><meta name="generator" content="Hugo 0.62.0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css" />
  <script src="https://kit.fontawesome.com/b76b73e8e8.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  <link rel="stylesheet" type="text/css" href="https://kiror0.github.io/ctf/css/styles.css" /></head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="https://kiror0.github.io/ctf/">Catousify</a>
            </h1>

      <ul id="social-media">
        
        
          
        <li><a href="https://github.com/kiror0"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a></li>
           
      </ul>
      
      <p><em>No Clever Tagline Needed.</em></p>
      
    </header>

    
<nav>
    <ul>
        
        <li>
            <a class="" href="https://kiror0.github.io/ctf/posts/">
                <i class="fa-li fa  fa-lg"></i><span>Posts</span>
            </a>
        </li>
        
        <li>
            <a class="" href="https://kiror0.github.io/ctf/about/">
                <i class="fa-li fa  fa-lg"></i><span>About Me</span>
            </a>
        </li>
        
    </ul>
</nav>

    <main>




<article>

    <h1>TUCTF 2017 - Reverse Engineering Writeup</h1>

    
        <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2017-11-27T18:01:11Z">Nov 27, 2017</time>
        </li>
        
        <li>
            Categories:
            <em>
                
                    
                    <a href="https://kiror0.github.io/ctf/categories/rev">rev</a>
                
                    , 
                    <a href="https://kiror0.github.io/ctf/categories/writeup">writeup</a>
                
            </em>
        </li>
        

        

        <li>6 minutes read</li>
    </ul>
</aside>

    

    <h1 id="funmail">Funmail</h1>
<blockquote>
<p>One of our employees has locked himself out of his account. can you help &lsquo;john galt&rsquo; recover his password? And no snooping around his emails you hear.</p>
</blockquote>
<p>UponÂ  running the binary given, user will be prompted to input username and password. The hints basically tells you everything. Use <code>john galt</code> as Username, then for password, use <code>ltrace ./funmail</code> to trace strcmp.</p>
<pre><code>strcmp(&quot;idontknow&quot;, &quot;this-password-is-a-secret-to-eve&quot;...)       = -1
</code></pre><p>ugh. Only small chunk of string is printed. To solve this use strings and grep for the password.</p>
<pre><code>$ strings ./funmail|grep password
*Incorrect password
this-password-is-a-secret-to-everyone!
password
</code></pre><p>So, <code>this-password-is-a-secret-to-everyone!</code> is the password. Now, run binary again.</p>
<pre><code>--Please login--
Username: john glat
*We have no users with the username: 'john glat'
--Please login--
Username: john galt
Password: this-password-is-a-secret-to-everyone!
Welcome john galt!
You have 1 unread email.
1) Read Email
2) Quit
&gt;\&gt; 1
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-
From:   Leeroy Jenkins
To:     whoisjohngalt
Subject: RE: I need a flag

Hey John it's Leeroy.
You were asking about a fun flag to use in your next challenge
and I think I got one. Tell me what you think of:
TUCTF{d0n7\_h4rdc0d3\_p455w0rd5}
Get back to me as soon as you can. Thanks!
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-

Flag : `TUCTF{d0n7_h4rdc0d3_p455w0rd5}`
</code></pre><h1 id="funmail20">Funmail2.0</h1>
<blockquote>
<p>john galt is having some problems with his email again. But this time it's not his fault. Can you help him?</p>
</blockquote>
<p>This challange is quite same with the first challange, except its tricky because even after input the right username and password, program will force exit. After sometime, I just realized that the sym.printFlag function is still there in the binary, but didnt get invoked. Solution, put break at the start then set rip (eip) to sym.printF;ag then continue. In radare2,</p>
<pre><code>[0xf7739030]&gt; db sym.main
[0xf775ab24]&gt; is ~Flag
vaddr=0xf775a785 paddr=0x00000785 ord=053 fwd=NONE sz=302 bind=GLOBAL type=FUNC name=printFlag
[0xf775ab24]&gt; dr eip=0xf775a785
0xf775ab24 -&gt;0xf775a785
[0xf775ab24]&gt; dc
TUCTF{l0c4l_&lt;\_r3m073\_3x3cu710n}
</code></pre><p>Flag : <code>TUCTF{l0c4l_&lt;_r3m073_3x3cu710n}</code></p>
<h1 id="unknown">Unknown</h1>
<blockquote>
<p>Diggin through some old files we discovered this binary. Although despite our inspection we can't figure out what it does. Or what it wants&hellip;</p>
</blockquote>
<p>Input hashed per character and check if character hash same with some constant. Solution, drop the character hash when its being compared. Recover the flag from constant and known hash from dropped hash.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> sys

<span style="color:#75715e"># defacto lib</span>
<span style="color:#66d9ef">try</span>:
    <span style="color:#f92672">import</span> r2pipe
<span style="color:#66d9ef">except</span> <span style="color:#a6e22e">ImportError</span> <span style="color:#66d9ef">as</span> err:
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Error while importing module r2pipe: </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> str(err))
    sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">1</span>)

unk_401DAC <span style="color:#f92672">=</span> [
    <span style="color:#ae81ff">0xFDFAB57A</span>,<span style="color:#ae81ff">0x032449A7</span>,<span style="color:#ae81ff">0x5F383821</span>,<span style="color:#ae81ff">0xFDFAB57A</span>,
    <span style="color:#ae81ff">0x25435E02</span>,<span style="color:#ae81ff">0x59E2EB0D</span>,<span style="color:#ae81ff">0x5ED756D7</span>,<span style="color:#ae81ff">0x5CFFF023</span>,
    <span style="color:#ae81ff">0x9239BDF3</span>,<span style="color:#ae81ff">0xF62C7F9B</span>,<span style="color:#ae81ff">0x63E13F5F</span>,<span style="color:#ae81ff">0xD6338E84</span>,
    <span style="color:#ae81ff">0x5CFFF023</span>,<span style="color:#ae81ff">0xFF20BDEF</span>,<span style="color:#ae81ff">0xC51F928E</span>,<span style="color:#ae81ff">0x63E13F5F</span>,
    <span style="color:#ae81ff">0xFF20BDEF</span>,<span style="color:#ae81ff">0xC51F928E</span>,<span style="color:#ae81ff">0xB59D1071</span>,<span style="color:#ae81ff">0xF62C7F9B</span>,
    <span style="color:#ae81ff">0xC51F928E</span>,<span style="color:#ae81ff">0x388D9870</span>,<span style="color:#ae81ff">0xFF20BDEF</span>,<span style="color:#ae81ff">0xCEECC5BA</span>,
    <span style="color:#ae81ff">0xA952136B</span>,<span style="color:#ae81ff">0x96710841</span>,<span style="color:#ae81ff">0xFF20BDEF</span>,<span style="color:#ae81ff">0xC51F928E</span>,
    <span style="color:#ae81ff">0xF536DFFD</span>,<span style="color:#ae81ff">0xCEECC5BA</span>,<span style="color:#ae81ff">0xA952136B</span>,<span style="color:#ae81ff">0xC5D7DAC4</span>,
    <span style="color:#ae81ff">0xFF20BDEF</span>,<span style="color:#ae81ff">0x12A92A61</span>,<span style="color:#ae81ff">0x63E13F5F</span>,<span style="color:#ae81ff">0xB59D1071</span>,
    <span style="color:#ae81ff">0xFF20BDEF</span>,<span style="color:#ae81ff">0x388D9870</span>,<span style="color:#ae81ff">0x63E13F5F</span>,<span style="color:#ae81ff">0xCD78354E</span>,
    <span style="color:#ae81ff">0xFF20BDEF</span>,<span style="color:#ae81ff">0xF2184419</span>,<span style="color:#ae81ff">0xCEECC5BA</span>,<span style="color:#ae81ff">0xCD78354E</span>,
    <span style="color:#ae81ff">0xC51F928E</span>,<span style="color:#ae81ff">0x3CA8BFDC</span>,<span style="color:#ae81ff">0xF62C7F9B</span>,<span style="color:#ae81ff">0x3CA8BFDC</span>,
    <span style="color:#ae81ff">0xF2184419</span>,<span style="color:#ae81ff">0xCEECC5BA</span>,<span style="color:#ae81ff">0xC51F928E</span>,<span style="color:#ae81ff">0x3CA8BFDC</span>,
    <span style="color:#ae81ff">0xA952136B</span>,<span style="color:#ae81ff">0x2FF35144</span>,<span style="color:#ae81ff">0xBA165EA7</span>,<span style="color:#ae81ff">0xEF1B84CD</span>
]

<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;&#39;&#39;</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74"># Stage 1 -- Recover the hashes --</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">alpha = [ </span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">, </span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">456789!()[]_-,.PADPADPADPADPADPADPADPADPADPADPADPADPADPA</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> ]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">for key in alpha:</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">    r2 = r2pipe.open(</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">./unknown</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">)</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">    r2.cmd(</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">ood </span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> + key)</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">    r2.cmd(</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">db 0x401f20</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">) # break on </span><span style="color:#e6db74">\</span><span style="color:#e6db74">`cmp eax, ecx</span><span style="color:#e6db74">\</span><span style="color:#e6db74">`</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">    for i in key:</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        r2.cmd(</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">dc</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">)</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        regs = r2.cmdj(</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">drj</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">)</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        # dump the hash into table</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">        print </span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">[</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> + i + </span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> ,</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74"> + hex(regs[</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">rax</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">]) + </span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">]</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">    r2.quit()</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;&#39;&#39;</span>

<span style="color:#75715e"># Stage 2 -- Recover the flag using known character hashes table --</span>
hashes <span style="color:#f92672">=</span> [ [<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">0</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x63e13f5f</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">1</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x3ca8bfdc</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">2</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xdd0e6ec0</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">3</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x5cfff023</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">4</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xceecc5ba</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">5</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xcc1be317</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">6</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x2ff35144</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">7</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xc51f928e</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">8</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xb6705910</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">9</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x26552da4</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">A</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x65d4bb53</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">B</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x62fe8700</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">C</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x5f383821</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">D</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x70e9ce39</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">E</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x5f9b4d91</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">F</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x25435e02</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">G</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x51beb40a</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">H</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x82d03951</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">I</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x1bd78865</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">J</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x81d23ebf</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">K</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xb8aa7c13</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">L</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x8e29337c</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">M</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x960c851a</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">N</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x9aecf4a0</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">O</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x3d5214b8</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">P</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xcab235fd</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Q</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x9c417714</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">R</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x010ef83b</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">S</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x87befa83</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">T</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xfdfab57a</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">U</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x032449a7</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">V</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xe67efe4f</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">W</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x3b957ccc</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">X</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xce39daba</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Y</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x69844214</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Z</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xcece4054</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">a</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x3893db85</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x0faf7ec1</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">c</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xf62c7f9b</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">d</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x96710841</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">e</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xb623c6c1</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x388d9870</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">g</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x382136b4</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">h</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xf536dffd</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">i</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x67258d77</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">j</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x5019d530</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">k</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xc5d7dac4</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">l</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x9239bdf3</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">m</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xd6338e84</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">n</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xa952136b</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">o</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x408a2c4b</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">p</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xf2184419</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">q</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x2c6485d5</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">r</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xcd78354e</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">s</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x98605ae6</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">t</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xc863df45</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">u</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xb59d1071</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">v</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xa4f459d3</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">w</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x5ed756d7</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">x</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x965ae173</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">y</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x12a92a61</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">z</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xe630810a</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">_</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xff20bdef</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0x59e2eb0d</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xef1b84cd</span>],
[<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">!</span><span style="color:#e6db74">&#39;</span> ,<span style="color:#ae81ff">0xba165ea7</span>] ]

flag <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">&#34;</span>

<span style="color:#66d9ef">for</span> u <span style="color:#f92672">in</span> unk_401DAC:
    <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> hashes:
        <span style="color:#66d9ef">if</span> k[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> u:
            flag <span style="color:#f92672">+</span><span style="color:#f92672">=</span> k[<span style="color:#ae81ff">0</span>]
            <span style="color:#66d9ef">break</span>

<span style="color:#66d9ef">print</span> flag

</code></pre></div><p>Flag : <code>TUCTF{w3lc0m3_70_7uc7f_4nd_7h4nk_y0u_f0r_p4r71c1p471n6!}</code></p>
<h1 id="future">Future</h1>
<blockquote>
<p>Future me gave me this and told me to add it to TUCTF. I dunno, he sounded crazy. Anyway, Let's see what's so special about it.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#75715e">#</span><span style="color:#75715e">include</span> 
<span style="color:#75715e">#include </span><span style="color:#75715e">
</span><span style="color:#75715e"></span><span style="color:#75715e">#</span><span style="color:#75715e">include</span> 

<span style="color:#75715e">void genMatrix(char mat[5][5], char str[]) {</span><span style="color:#75715e">
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">25</span>; i<span style="color:#f92672">+</span><span style="color:#f92672">+</span>) {
        <span style="color:#66d9ef">int</span> m <span style="color:#f92672">=</span> (i <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">25</span>;
        <span style="color:#66d9ef">int</span> f <span style="color:#f92672">=</span> (i <span style="color:#f92672">*</span> <span style="color:#ae81ff">7</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">25</span>;
        mat[m<span style="color:#f92672">/</span><span style="color:#ae81ff">5</span>][m<span style="color:#f92672">%</span><span style="color:#ae81ff">5</span>] <span style="color:#f92672">=</span> str[f];
    }
}

<span style="color:#66d9ef">void</span> genAuthString(<span style="color:#66d9ef">char</span> mat[<span style="color:#ae81ff">5</span>][<span style="color:#ae81ff">5</span>], <span style="color:#66d9ef">char</span> auth[]) {
    auth[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> mat[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">4</span>][<span style="color:#ae81ff">4</span>];
    auth[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> mat[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">2</span>];
    auth[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> mat[<span style="color:#ae81ff">4</span>][<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">4</span>][<span style="color:#ae81ff">1</span>];
    auth[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> mat[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">3</span>][<span style="color:#ae81ff">1</span>];
    auth[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> mat[<span style="color:#ae81ff">3</span>][<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">2</span>];
    auth[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">=</span> mat[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">3</span>];
    auth[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">=</span> mat[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>];
    auth[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">=</span> mat[<span style="color:#ae81ff">3</span>][<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">3</span>][<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">3</span>];
    auth[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">=</span> mat[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">4</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">1</span>];
    auth[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">=</span> mat[<span style="color:#ae81ff">3</span>][<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>];
    auth[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">=</span> mat[<span style="color:#ae81ff">4</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">2</span>];
    auth[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">=</span> mat[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">4</span>][<span style="color:#ae81ff">1</span>];
    auth[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">=</span> mat[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">2</span>];
    auth[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">=</span> mat[<span style="color:#ae81ff">3</span>][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">0</span>];
    auth[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">=</span> mat[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">2</span>];
    auth[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">=</span> mat[<span style="color:#ae81ff">4</span>][<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">3</span>];
    auth[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> mat[<span style="color:#ae81ff">2</span>][<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">2</span>];
    auth[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">=</span> mat[<span style="color:#ae81ff">1</span>][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> mat[<span style="color:#ae81ff">4</span>][<span style="color:#ae81ff">1</span>];
}

<span style="color:#66d9ef">int</span> main() {
    <span style="color:#66d9ef">char</span> flag[<span style="color:#ae81ff">26</span>];
    printf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">What&#39;s the flag: </span><span style="color:#e6db74">&#34;</span>);
    scanf(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%25s</span><span style="color:#e6db74">&#34;</span>, flag);
    flag[<span style="color:#ae81ff">25</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;

    <span style="color:#66d9ef">if</span> (strlen(flag) <span style="color:#f92672">!</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">25</span>) {
        puts(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Try harder.</span><span style="color:#e6db74">&#34;</span>);
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
    }

    <span style="color:#75715e">// Setup matrix
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">char</span> mat[<span style="color:#ae81ff">5</span>][<span style="color:#ae81ff">5</span>];<span style="color:#75715e">// Matrix for a jumbled string
</span><span style="color:#75715e"></span>    genMatrix(mat, flag);
    <span style="color:#75715e">// Generate auth string
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">char</span> auth[<span style="color:#ae81ff">19</span>]; <span style="color:#75715e">// The auth string they generate
</span><span style="color:#75715e"></span>    auth[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; <span style="color:#75715e">// null byte
</span><span style="color:#75715e"></span>    genAuthString(mat, auth);
    <span style="color:#66d9ef">char</span> pass[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x8b</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">xce</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">xb0</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x89</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x7b</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">xb0</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">xb0</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">xee</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">xbf</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x92</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x65</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x9d</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x9a</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x99</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x99</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x94</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">xad</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">xe4</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x00</span><span style="color:#e6db74">&#34;</span>;

    <span style="color:#75715e">// Check the input
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>strcmp(pass, auth)) {
        puts(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Yup thats the flag!</span><span style="color:#e6db74">&#34;</span>);
    } <span style="color:#66d9ef">else</span> {
        puts(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Nope. Try again.</span><span style="color:#e6db74">&#34;</span>);
    }

    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><p>In this challange, program will calculate our input and check if its same with <code>pass</code> constant. I'm using Z3 smt solver to solve this and add TUCTF flag format as a constraint, because if it isn't Z3 will give another uintended solution.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/env python</span>
<span style="color:#f92672">from</span> z3 <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
<span style="color:#f92672">import</span> string

s <span style="color:#f92672">=</span> Solver()

const <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x8b</span>, <span style="color:#ae81ff">0xce</span>, <span style="color:#ae81ff">0xb0</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x7b</span>, <span style="color:#ae81ff">0xb0</span>, <span style="color:#ae81ff">0xb0</span>, <span style="color:#ae81ff">0xee</span>, <span style="color:#ae81ff">0xbf</span>, <span style="color:#ae81ff">0x92</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x9d</span>, <span style="color:#ae81ff">0x9a</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0x94</span>, <span style="color:#ae81ff">0xad</span>, <span style="color:#ae81ff">0xe4</span>]

str <span style="color:#f92672">=</span> [BitVec(i, <span style="color:#ae81ff">8</span>) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> xrange(<span style="color:#ae81ff">25</span>)]

alpha <span style="color:#f92672">=</span> string<span style="color:#f92672">.</span>letters <span style="color:#f92672">+</span> string<span style="color:#f92672">.</span>digits <span style="color:#f92672">+</span> string<span style="color:#f92672">.</span>punctuation

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> xrange(<span style="color:#ae81ff">25</span>):
    <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> xrange(<span style="color:#ae81ff">0xFF</span>):
        <span style="color:#66d9ef">if</span> chr(x) <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> alpha:
            s<span style="color:#f92672">.</span>add(str[i] <span style="color:#f92672">!=</span> x)

s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">T</span><span style="color:#e6db74">&#39;</span>))
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">U</span><span style="color:#e6db74">&#39;</span>))
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">C</span><span style="color:#e6db74">&#39;</span>))
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">T</span><span style="color:#e6db74">&#39;</span>))
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">F</span><span style="color:#e6db74">&#39;</span>))
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span><span style="color:#e6db74">&#39;</span>))
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">24</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>))

s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">==</span> const[<span style="color:#ae81ff">0</span>])
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">==</span> const[<span style="color:#ae81ff">1</span>])
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">==</span> const[<span style="color:#ae81ff">2</span>])
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">==</span> const[<span style="color:#ae81ff">3</span>])
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">==</span> const[<span style="color:#ae81ff">4</span>])
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">==</span> const[<span style="color:#ae81ff">5</span>])
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">24</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">==</span> const[<span style="color:#ae81ff">6</span>])
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">22</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">23</span>] <span style="color:#f92672">==</span> const[<span style="color:#ae81ff">7</span>])
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">==</span> const[<span style="color:#ae81ff">8</span>])
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">==</span> const[<span style="color:#ae81ff">9</span>])
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">==</span> const[<span style="color:#ae81ff">10</span>])
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">==</span> const[<span style="color:#ae81ff">11</span>])
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">23</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">==</span> const[<span style="color:#ae81ff">12</span>])
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">==</span> const[<span style="color:#ae81ff">13</span>])
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">==</span> const[<span style="color:#ae81ff">14</span>])
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">==</span> const[<span style="color:#ae81ff">15</span>])
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">==</span> const[<span style="color:#ae81ff">16</span>])
s<span style="color:#f92672">.</span>add(str[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">+</span> str[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">==</span> const[<span style="color:#ae81ff">17</span>])

<span style="color:#66d9ef">if</span> s<span style="color:#f92672">.</span>check() <span style="color:#f92672">==</span> sat:
    model <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>model()
    flag <span style="color:#f92672">=</span> [chr(model[x]<span style="color:#f92672">.</span>as_long()) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> str]
    <span style="color:#66d9ef">print</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>join(flag)
<span style="color:#66d9ef">else</span>:
    <span style="color:#66d9ef">print</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">Nope :(</span><span style="color:#e6db74">&#39;</span>

<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;&#39;&#39;</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[0][0] = str[0]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[2][1] = str[1]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[4][2] = str[2]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[1][3] = str[3]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[3][4] = str[4]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[1][0] = str[5]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[3][1] = str[6]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[0][2] = str[7]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[2][3] = str[8]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[4][4] = str[9]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[2][0] = str[10]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[4][1] = str[11]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[1][2] = str[12]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[3][3] = str[13]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[0][4] = str[14]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[3][0] = str[15]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[0][1] = str[16]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[2][2] = str[17]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[4][3] = str[18]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[1][4] = str[19]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[4][0] = str[20]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[1][1] = str[21]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[3][2] = str[22]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[0][3] = str[23]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">mat[2][4] = str[24]</span><span style="color:#e6db74">
</span><span style="color:#e6db74"></span><span style="color:#e6db74">&#39;&#39;&#39;</span>
</code></pre></div><p>Flag : <code>TUCTF{5y573m5_0f_4_d0wn!}</code></p>


</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="https://kiror0.github.io/ctf/posts/agrihack-0x2-lift-rektorat-writeup/"><i class="fa fa-chevron-circle-left"></i> AgriHack 0x2 - Lift Rektorat Writeup</a>
        </li>
        
        
        <li>
            <a href="https://kiror0.github.io/ctf/posts/tpctf-2017-bad-encryption-writeup/">TPCTF 2017 - Bad Encryption Writeup <i class="fa fa-chevron-circle-right"></i> </a>
        </li>
        
    </ul>
</section>
    





</main>
    <footer>
        <h6>Copyright Â© 2019 - kiror0 |
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="https://kiror0.github.io/ctf/index.xml">Subscribe</a></h6>
    </footer>
</div>
<script src="https://kiror0.github.io/ctf/js/scripts.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-146594173-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


</body>

</html>
