<!doctype html>

<html lang="en-us">

<head>
  <title>Catousify</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="The HTML5 Herald" />
  <meta name="author" content="kiror0" /><meta name="generator" content="Hugo 0.62.0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css" />
  <script src="https://kit.fontawesome.com/b76b73e8e8.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  <link rel="stylesheet" type="text/css" href="http://zeroload.github.io/css/styles.css" /></head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="http://zeroload.github.io/">Catousify</a>
            </h1>

      <ul id="social-media">
        
        
          
        <li><a href="https://github.com/kiror0"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a></li>
           
      </ul>
      
      <p><em>No Clever Tagline Needed.</em></p>
      
    </header>

    
<nav>
    <ul>
        
        <li>
            <a class="" href="http://zeroload.github.io/posts/">
                <i class="fa-li fa  fa-lg"></i><span>Posts</span>
            </a>
        </li>
        
        <li>
            <a class="" href="http://zeroload.github.io/about/">
                <i class="fa-li fa  fa-lg"></i><span>About Me</span>
            </a>
        </li>
        
    </ul>
</nav>

    <main>




<article>

    <h1>CTFZone 2018 Quals - android_ololo_country_checker</h1>

    
        <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2018-07-23T08:21:09Z">Jul 23, 2018</time>
        </li>
        
        <li>
            Categories:
            <em>
                
                    
                    <a href="http://zeroload.github.io/categories/rev">rev</a>
                
                    , 
                    <a href="http://zeroload.github.io/categories/writeup">writeup</a>
                
            </em>
        </li>
        

        

        <li>6 minutes read</li>
    </ul>
</aside>

    

    <blockquote>
<p>It's a foreign android application. Let's try to guess the country!
<!-- raw HTML omitted -->Solves : 9
<!-- raw HTML omitted -->Point : 314. (Dynamic Score)
<!-- raw HTML omitted -->Download :
<!-- raw HTML omitted -->- <a href="https://ctf.bi.zone/files/ololo.8ed245a0a90f801ebf8ccf0676564ff1">ololo.8ed245a0a90f801ebf8ccf0676564ff1</a>
<!-- raw HTML omitted -->- <a href="http://zeroload.github.io/img/ctfzone2018/native-lib.c">native-lib.c</a>
<!-- raw HTML omitted -->- <a href="http://zeroload.github.io/img/ctfzone2018/MainActivity.java">MainActivity.java</a></p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">λ › file ololo.8ed245a0a90f801ebf8ccf0676564ff1
ololo.8ed245a0a90f801ebf8ccf0676564ff1: Zip archive data, at least v?<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> to extract
λ › jarsigner -verify ololo.8ed245a0a90f801ebf8ccf0676564ff1

jar is unsigned.
λ › unzip -l ololo.8ed245a0a90f801ebf8ccf0676564ff1
Archive:  ololo.8ed245a0a90f801ebf8ccf0676564ff1
  Length      Date    Time    Name
---------  ---------- -----   ----
     <span style="color:#ae81ff">2592</span>  00-00-1980 00:00   AndroidManifest.xml
       <span style="color:#ae81ff">87</span>  00-00-1980 00:00   META-INF/MANIFEST.MF
    <span style="color:#ae81ff">15804</span>  00-00-1980 00:00   classes.dex
    <span style="color:#ae81ff">36184</span>  00-00-1980 00:00   lib/armeabi-v7a/libnative-lib.so
     <span style="color:#ae81ff">2192</span>  00-00-1980 00:00   res/layout/activity_main.xml
   <span style="color:#ae81ff">473197</span>  00-00-1980 00:00   res/raw/a123hj1sa.png
   <span style="color:#ae81ff">457171</span>  00-00-1980 00:00   res/raw/hjdsajg12.png
   <span style="color:#ae81ff">578662</span>  00-00-1980 00:00   res/raw/j4321saa.png
   <span style="color:#ae81ff">576558</span>  00-00-1980 00:00   res/raw/kj1234c1.png
   <span style="color:#ae81ff">388063</span>  00-00-1980 00:00   res/raw/kjwqre32.png
   <span style="color:#ae81ff">578662</span>  00-00-1980 00:00   res/raw/mvke321kjd.png
     <span style="color:#ae81ff">1856</span>  00-00-1980 00:00   resources.arsc
---------                     -------
  <span style="color:#ae81ff">3111028</span>                     <span style="color:#ae81ff">12</span> files
</code></pre></div><p>APK is unsigned, thus we need to sign the APK first if we're going to do dynamic analysis. There are many ways to do this, Google it. There is another thing important to note, the native-lib is <strong>armeabi-v7a</strong> specific, it's better to have a phone support that CPU or use AVD emulator (comes with Android SDK) with armeabi-v7a system image.</p>
<p>Decompile classes.dex, use <code>apktool</code> for make changes to <code>*.smali</code> and <code>cfr</code> for decompile jar to java, easier to read than smali if you're not familiar with it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">/* See attachment above (MainActivity.java) */</span>
</code></pre></div><p>We will focus on 2 functions, <code>checkSomethings(int var1)</code> dan <code>getSoBody()</code>.</p>
<p><code>getSoBody()</code>, unpack partial data from raw resource. The starting point is written at the end of file. Take a look at example,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">λ › hexdump -C ./res/raw/a123hj1sa.png
...
00060e60  4e ff ff ec df cf fe fd  ec df cf fe fd ec df ff  |N...............|
00060e70  <span style="color:#ae81ff">74</span> ff 7e <span style="color:#ae81ff">46</span> d0 3f fb f7  b3 7f 3f fb f7 b3 7f ff  |t.~F.?....?.....|
00060e80  <span style="color:#ae81ff">53</span> fe <span style="color:#ae81ff">33</span> fb 1f f1 cd <span style="color:#ae81ff">56</span>  d2 <span style="color:#ae81ff">67</span> <span style="color:#ae81ff">53</span> 4d <span style="color:#ae81ff">99</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">00</span>  |S.3....V.gSM....|
00060e90  <span style="color:#ae81ff">00</span> <span style="color:#ae81ff">49</span> <span style="color:#ae81ff">45</span> 4e <span style="color:#ae81ff">44</span> ae <span style="color:#ae81ff">42</span> <span style="color:#ae81ff">60</span>  <span style="color:#ae81ff">82</span> dc <span style="color:#ae81ff">16</span> <span style="color:#ae81ff">51</span> e9 <span style="color:#ae81ff">90</span> 1f da  |.IEND.B<span style="color:#e6db74">`</span>...Q....|
00060ea0  fd <span style="color:#ae81ff">79</span> <span style="color:#ae81ff">76</span> 3f <span style="color:#ae81ff">27</span> f3 <span style="color:#ae81ff">01</span> 5e  <span style="color:#ae81ff">09</span> 9c <span style="color:#ae81ff">33</span> <span style="color:#ae81ff">64</span> c8 0f <span style="color:#ae81ff">81</span> <span style="color:#ae81ff">46</span>  |.yv?<span style="color:#960050;background-color:#1e0010">&#39;</span>..^..3d...F|
00060eb0  9e <span style="color:#ae81ff">76</span> fb <span style="color:#ae81ff">77</span> ed fa b2 e2  <span style="color:#ae81ff">05</span> <span style="color:#ae81ff">97</span> 4b c9 <span style="color:#ae81ff">80</span> fe 2f bc  |.v.w......K.../.|
00060ec0  <span style="color:#ae81ff">03</span> 3d <span style="color:#ae81ff">57</span> 3c d6 1c <span style="color:#ae81ff">20</span> <span style="color:#ae81ff">61</span>  <span style="color:#ae81ff">97</span> 6c e5 a3 2a fe <span style="color:#ae81ff">95</span> ed  |.<span style="color:#f92672">=</span>W&lt;.. a.l..*...|
...
<span style="color:#ae81ff">00073850</span>  a3 af 0c d5 e3 <span style="color:#ae81ff">59</span> d7 3f  f7 ea 5e b2 bd 7e f4 cc  |.....Y.?..^..~..|
<span style="color:#ae81ff">00073860</span>  9e <span style="color:#ae81ff">68</span> 3e <span style="color:#ae81ff">77</span> ac bb <span style="color:#ae81ff">21</span> d1  <span style="color:#ae81ff">46</span> <span style="color:#ae81ff">99</span> 0e <span style="color:#ae81ff">06</span> <span style="color:#ae81ff">00</span>           |.h&gt;w..!.F....|
</code></pre></div><p><code>IEND ?? ?? ?? ??</code> this is the signature for the end of PNG file, but there are still many trailing data following it. Assume this data is important for later, let's make a script to unpack it.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> struct <span style="color:#f92672">import</span> unpack
<span style="color:#f92672">import</span> sys

u32 <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> x : unpack(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">I</span><span style="color:#e6db74">&#34;</span>, x)[<span style="color:#ae81ff">0</span>]

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, len(sys<span style="color:#f92672">.</span>argv)):
    <span style="color:#66d9ef">if</span> sys<span style="color:#f92672">.</span>argv[i] <span style="color:#f92672">==</span> sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">0</span>]:
        <span style="color:#66d9ef">continue</span>

    basename <span style="color:#f92672">=</span> sys<span style="color:#f92672">.</span>argv[i]<span style="color:#f92672">.</span>split(<span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">.</span><span style="color:#e6db74">&#39;</span>)[<span style="color:#ae81ff">0</span>]
    
    <span style="color:#66d9ef">with</span> open(sys<span style="color:#f92672">.</span>argv[i], <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">rb</span><span style="color:#e6db74">&#39;</span>) <span style="color:#66d9ef">as</span> f:
        data <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()
        length <span style="color:#f92672">=</span> end <span style="color:#f92672">=</span> len(data)
    
    start <span style="color:#f92672">=</span> u32(data[length<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>:length])
    
    <span style="color:#66d9ef">with</span> open(basename <span style="color:#f92672">+</span> <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">.bin</span><span style="color:#e6db74">&#39;</span>, <span style="color:#e6db74"></span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">wb</span><span style="color:#e6db74">&#39;</span>) <span style="color:#66d9ef">as</span> f:
        f<span style="color:#f92672">.</span>write(data[start:end<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>])
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">λ › <span style="color:#66d9ef">for</span> i in <span style="color:#66d9ef">$(</span>ls ./res/raw | grep .bin<span style="color:#66d9ef">)</span>; <span style="color:#66d9ef">do</span>; echo $i <span style="color:#66d9ef">$(</span>cat $i | wc -c<span style="color:#66d9ef">)</span>; <span style="color:#66d9ef">done</span>
a123hj1sa.bin <span style="color:#ae81ff">76240</span>
hjdsajg12.bin <span style="color:#ae81ff">76240</span>
j4321saa.bin <span style="color:#ae81ff">76240</span>
kj1234c1.bin <span style="color:#ae81ff">76240</span>
kjwqre32.bin <span style="color:#ae81ff">76240</span>
mvke321kjd.bin <span style="color:#ae81ff">76240</span>
</code></pre></div><p>Okay, this is getting interesting. The data we have are the same size, moreover it's a multiples of 16 <code>(76240 % 16 == 0)</code>. The fact that all the data dosn't make sense, we can assume that we are dealing with some sort of block cipher later.</p>
<p><code>checkSomethings(int var1)</code> is a native function, so we have to open libnative-lib.so in disassembler/decompiler.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#75715e">/* See attachment above (native-lib.c) */</span>
</code></pre></div><p>Woa. this. is. huge. The actual deompiled from IDA doesn't have all these nice variables and functions name. The first thing I did was reading it from the bottom part. The last function before return called piqued my interest, because it calls <code>getSoBody()</code> and <code>getSoPath()</code> from java, after that, the data returned from <code>getSoBody()</code> passed to another function. The function use some constant which you can guess, sbox from AES. So, we know that the app uses AES to decrypt data from raw resource, but what about the keys?</p>
<p>The keys are crc32 calculated from some ID in android (<code>Line1Number</code>, <code>deviceID</code>, <code>subscriberID</code>, <code>packageName</code>, <code>sdk_ver</code>, <code>simCountryISO</code>). The hint for correct string are md5sum in <code>.data</code> section (<code>byte_XXXX</code>). You can see that in <code>checkSomethings(int)</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-C" data-lang="C"><span style="color:#66d9ef">while</span> ( md5_deviceID[v57] <span style="color:#f92672">=</span><span style="color:#f92672">=</span> byte_9729[v57] )
{
  v39 <span style="color:#f92672">=</span> __OFSUB__(v57, <span style="color:#ae81ff">14</span>);
  v37 <span style="color:#f92672">=</span> v57 <span style="color:#f92672">=</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">14</span>;
  v38 <span style="color:#f92672">=</span> v57<span style="color:#f92672">+</span><span style="color:#f92672">+</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">14</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>;
  <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">!</span>((<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)(v38 <span style="color:#f92672">^</span> v39) <span style="color:#f92672">|</span> v37) )
  {
    dword_9AA8[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">|</span><span style="color:#f92672">=</span> <span style="color:#ae81ff">1u</span>;
    <span style="color:#66d9ef">break</span>;
  }
}
</code></pre></div><p>Looking up the hash value online, we could know what's the correct strings.</p>
<pre><code>phone    = 8203412(03bec67d849e7114f1a828e1628495fe)/7793952(c377ec2ae9bc906448b6c39326e42f04)
deviceID = 89123988(e176e3acf427e59308520009b3e2a793)/01982375(b400b6e082104ce63f18f45e64c2fbfd)
iso_code = KZ(4aceb7d6b4564ec96bc6605cd5af37e7)/KG(56d721ccadb8bbfd8b47390d82a6ea4b)
subscriberID = 31231712(5b529e731eab2fb96185b0e9769fc498)
sdk_ver  = 19(1f0e3dad99908345f7439f8ffabdffc4)
package_name = ololo.ololo.ololo(5b4802bc02112666dabafe0c77ac18d0)
</code></pre><p>There's a problem though, assuming all of it as correct, some calculated md5 are checked 2 times, which means there will be 2 options for the correct string. From this point static analysis just getting hazy. Thus, i just decided to use all the possible options. There are only 3 ID with 2 options, (<code>2*2*2 = 8</code>) which will ends up with 8 possible combination, enough to do it by hands xD.</p>
<p>Rather than directly modify smali files (It'll took too much time since you'll need to modify, recompile, sign, and install. again and again), It's better to use things like <code>xposed</code> or <code>frida</code>. I used frida because it's easy to setup in emulator. Here's the final frida script,</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">Java</span>.<span style="color:#a6e22e">perform</span>(<span style="color:#66d9ef">function</span> () {
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">JavaString</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Java</span>.<span style="color:#a6e22e">use</span>(<span style="color:#e6db74">&#39;java.lang.String&#39;</span>);
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">EADB</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Java</span>.<span style="color:#a6e22e">use</span>(<span style="color:#e6db74">&#34;aaa.aie.eadb&#34;</span>);
    <span style="color:#a6e22e">EADB</span>.<span style="color:#a6e22e">headb</span>.<span style="color:#a6e22e">implementation</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> () {
        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Called - aaa.aib.aib()&#34;</span>);
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>;
    }
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">EKPN</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Java</span>.<span style="color:#a6e22e">use</span>(<span style="color:#e6db74">&#34;aaa.aie.ekpn&#34;</span>); <span style="color:#75715e">// PhoneNumber
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">EKPN</span>.<span style="color:#a6e22e">egln</span>.<span style="color:#a6e22e">implementation</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> () {
        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Called - aaa.aie.ekpn.egln()&#34;</span>);
        <span style="color:#75715e">// return &#34;7793952&#34;;
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;8203412&#34;</span>;
    };
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">EKD</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Java</span>.<span style="color:#a6e22e">use</span>(<span style="color:#e6db74">&#34;aaa.aie.ekd&#34;</span>); <span style="color:#75715e">// DeviceId
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">EKD</span>.<span style="color:#a6e22e">egdi</span>.<span style="color:#a6e22e">implementation</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> () {
        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Called - aaa.aie.ekd.egdi()&#34;</span>);
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;89123988&#34;</span>;
        <span style="color:#75715e">// return &#34;01982375&#34;;
</span><span style="color:#75715e"></span>    };
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">EKL</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Java</span>.<span style="color:#a6e22e">use</span>(<span style="color:#e6db74">&#34;aaa.aie.ekl&#34;</span>); <span style="color:#75715e">// SimIsoCountry
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">EKL</span>.<span style="color:#a6e22e">egsci</span>.<span style="color:#a6e22e">implementation</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> () {
        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Called - aaa.aie.ekl.egcsi()&#34;</span>);
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;KZ&#34;</span>;
        <span style="color:#75715e">// return &#34;KG&#34;;
</span><span style="color:#75715e"></span>    }
    <span style="color:#75715e">// var EKA = Java.use(&#34;aaa.aie.eka&#34;);
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// EKA.ega.implementation = function () {
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//     console.log(&#34;Called - aaa.aie.eka.ega()&#34;);
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//     return JavaString.$new(&#34;19&#34;);
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// }
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// EKA.egn.implementation = function () {
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//     console.log(&#34;Called - aaa.aie.eka.egn()&#34;);
</span><span style="color:#75715e"></span>    <span style="color:#75715e">//     return &#34;ololo.ololo.ololo&#34;;
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// }
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">EKI</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Java</span>.<span style="color:#a6e22e">use</span>(<span style="color:#e6db74">&#34;aaa.aie.eki&#34;</span>);
    <span style="color:#a6e22e">EKI</span>.<span style="color:#a6e22e">egsi</span>.<span style="color:#a6e22e">implementation</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span> () {
        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Called - aaa.aie.eki.egsi()&#34;</span>);
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;31231712&#34;</span>;
    }
    <span style="color:#a6e22e">Java</span>.<span style="color:#a6e22e">choose</span>(<span style="color:#e6db74">&#34;ololo.ololo.ololo.MainActivity&#34;</span>, {
        <span style="color:#a6e22e">onMatch</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">instance</span>) {
            <span style="color:#a6e22e">instance</span>.<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">value</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
            <span style="color:#a6e22e">instance</span>.<span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">value</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
        },
        <span style="color:#a6e22e">onComplete</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span> () {}
    });
});
</code></pre></div><p>Run the app, attach frida with the script above, boom, got the flag,</p>
<p><img src="http://zeroload.github.io/img/ctfzone2018/ololo1.png" alt="">
<img src="http://zeroload.github.io/img/ctfzone2018/ololo2.png" alt=""></p>
<!-- raw HTML omitted -->
<hr>
<p>Some notes and failed attack ideas. The first approach was static analysis and rewrite all of important function in C to decrypt raw data. The result? It fails miserably, it took me 1 hour to get to know frida and the flag, while rewrite took me 8 hours (8 hours of coding, mostly contemplating and asking what the fck am I doing for of not getting any progress. sad.) While the first reverse engineer part (decompile, analysis, and stuff) took me 1-2 hours. Yep, better to get another unique ideas if you are stuck for a long time. <del>but how? idk. sad.</del></p>


</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="http://zeroload.github.io/posts/security-fest-ctf-2018-bluepill/"><i class="fa fa-chevron-circle-left"></i> Security Fest CTF 2018 - bluepill</a>
        </li>
        
        
        <li>
            <a href="http://zeroload.github.io/posts/slashroot-2018-snow-lan-d/">SlashRoot 2018 - SNOW LAN(D) <i class="fa fa-chevron-circle-right"></i> </a>
        </li>
        
    </ul>
</section>
    





</main>
    <footer>
        <h6>Copyright © 2019 - kiror0 |
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="http://zeroload.github.io/index.xml">Subscribe</a></h6>
    </footer>
</div>
<script src="http://zeroload.github.io/js/scripts.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-146594173-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


</body>

</html>
